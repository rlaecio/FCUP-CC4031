Vagrant.configure("2") do |config|
  # --- Rede base ---
  BASE_IP = "172.10.10."

  # --- Configuração padrão ---
  config.vm.box_check_update = false

  # --- Rocky Server ---
  config.vm.define "rocky_server" do |srv|
    srv.vm.box = "rockylinux/9"
    srv.vm.hostname = "rocky-server"
    srv.vm.network "private_network", ip: "#{BASE_IP}10"
    srv.vm.provider "virtualbox" do |vb|
      vb.name = "rocky_server"
      vb.memory = 2048
      vb.cpus = 2
    end
    srv.vm.provision "ansible" do |ansible|
      ansible.playbook = "playbook.yml"
      ansible.inventory_path = "hosts.ini"
      ansible.limit = "rocky_server"
    end
  end

  # --- Rocky Desktop ---
  config.vm.define "rocky_desktop" do |desk|
    desk.vm.box = "rockylinux/9"
    desk.vm.hostname = "rocky-desktop"
    desk.vm.network "private_network", ip: "#{BASE_IP}11"
    desk.vm.provider "virtualbox" do |vb|
      vb.name = "rocky_desktop"
      vb.memory = 4096
      vb.cpus = 2
    end
    desk.vm.provision "ansible" do |ansible|
      ansible.playbook = "playbook.yml"
      ansible.inventory_path = "hosts.ini"
      ansible.limit = "rocky_desktop"
    end
  end

  # --- Kali Linux ---
  config.vm.define "kali" do |kali|
    kali.vm.box = "kalilinux/rolling"
    kali.vm.hostname = "kali"
    kali.vm.network "private_network", ip: "#{BASE_IP}12"
    kali.vm.provider "virtualbox" do |vb|
      vb.name = "kali"
      vb.memory = 2048
      vb.cpus = 2
    end
    kali.vm.provision "ansible" do |ansible|
      ansible.playbook = "playbook.yml"
      ansible.inventory_path = "hosts.ini"
      ansible.limit = "kali"
    end
  end
end
